webpackJsonp([2],{162:function(e,l,t){function a(e){t(198)}var i=t(9)(t(200),t(201),a,null,null);e.exports=i.exports},198:function(e,l,t){var a=t(199);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t(17)("a294014e",a,!0)},199:function(e,l,t){l=e.exports=t(7)(),l.push([e.i,"",""])},200:function(e,l,t){"use strict";Object.defineProperty(l,"__esModule",{value:!0}),l.default={data:function(){return{illegalVisible:!1,punishVisible:!1,loading:!0,users:[],illegals:[],userIllegals:[],selIllegalUser:[],addIllegal:{ids:[],illegal_id:"",cause:"",time:""},addPunish:{user_id:"",illegal_id:"",type:"",count:"",content:"",time:""},punishRules:{count:[{required:!0,message:"请输入抵消数量"}],time:[{required:!0,message:"请输入惩罚时间"}],content:[{required:!0,message:"请输入惩罚内容"}]}}},methods:{info:function(){var e=this;this.loading=!0,axios.get("/admin/user/get/illegal").then(function(l){var t=l.data;e.users=t.users,e.illegals=t.illegals,e.userIllegals=t.userIllegals,e.loading=!1})},mtDate:function(e){var l=new Date;l.setTime(1e3*e);var t=l.getFullYear(),a=l.getMonth()+1;a=a<10?"0"+a:a;var i=l.getDate();i=i<10?"0"+i:i;var s=l.getHours();s=s<10?"0"+s:s;var n=l.getMinutes(),d=l.getSeconds();return n=n<10?"0"+n:n,d=d<10?"0"+d:d,t+"-"+a+"-"+i+" "+s+":"+n+":"+d},addIllegalFun:function(){var e=this;0===this.addIllegal.ids.length?this.$message({message:"请选择用户",type:"warning"}):this.addIllegal.illegal_id?this.addIllegal.time?(this.loading=!0,axios.post("/admin/user/set/illegal",this.addIllegal).then(function(l){var t=l.data;1===t.code?(e.$message({message:"添加成功",type:"success"}),e.illegalVisible=!1,e.addIllegal={ids:[],illegal_id:"",cause:"",time:""},e.info()):e.$message({message:t.msg,type:"error"}),e.loading=!1})):this.$message({message:"请选择时间",type:"warning"}):this.$message({message:"请选择类型",type:"warning"})},punishFun:function(e,l){this.addPunish={user_id:"",illegal_id:"",type:"",count:"",content:"",time:""},this.addPunish.user_id=l.id,this.addPunish.illegal_id=l.illegal.id,this.addPunish.type=l.illegal.name,this.punishVisible=!0},addPunishFun:function(e){var l=this;this.$refs[e].validate(function(e){if(!e)return!1;l.loading=!0,axios.post("/admin/user/set/punish",l.addPunish).then(function(e){var t=e.data;1===t.code?(l.$message({message:"添加成功",type:"success"}),l.punishVisible=!1,l.info()):l.$message({message:t.msg,type:"error"}),l.loading=!1})})},delUserIllegal:function(e){var l=this;this.$confirm("确认删除此条违规吗，删除后将无法恢复？").then(function(t){l.loading=!0,axios.post("/admin/user/del/illegal",{id:e}).then(function(e){var t=e.data;1===t.code?(l.$message({message:"删除成功",type:"success"}),l.info()):l.$message({message:t.msg,type:"error"}),l.loading=!1})})}},mounted:function(){this.info()}}},201:function(e,l){e.exports={render:function(){var e=this,l=e.$createElement,t=e._self._c||l;return t("div",[t("div",[t("el-button",{attrs:{type:"primary"},on:{click:function(l){e.illegalVisible=!0}}},[e._v("添加违规")])],1),e._v(" "),t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.userIllegals}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("ul",e._l(l.row.illegals,function(l){return t("li",[e._v("\n                            "+e._s(e.mtDate(l.time))+"-"+e._s(l.cause)+"\n\n                            "),t("el-button",{attrs:{size:"small"},on:{click:function(t){e.delUserIllegal(l.id)}}},[e._v("删除")])],1)}))]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"分组"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("span",[e._v(e._s(l.row.grouping.name))])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"姓名",prop:"name"}}),e._v(" "),t("el-table-column",{attrs:{label:"类型",prop:"type",sortable:""}}),e._v(" "),t("el-table-column",{attrs:{label:"次数",prop:"count"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.punishFun(l.$index,l.row)}}},[e._v("惩罚")])]}}])})],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"添加违规",visible:e.illegalVisible},on:{"update:visible":function(l){e.illegalVisible=l}}},[t("el-form",{attrs:{model:e.addIllegal,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"用户"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",filterable:"",placeholder:"请选择用户"},model:{value:e.addIllegal.ids,callback:function(l){e.addIllegal.ids=l},expression:"addIllegal.ids"}},e._l(e.users,function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"类型"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},model:{value:e.addIllegal.illegal_id,callback:function(l){e.addIllegal.illegal_id=l},expression:"addIllegal.illegal_id"}},e._l(e.illegals,function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"时间"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间",align:"right"},model:{value:e.addIllegal.time,callback:function(l){e.addIllegal.time=l},expression:"addIllegal.time"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"说明"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入事情细节(选填)"},model:{value:e.addIllegal.cause,callback:function(l){e.addIllegal.cause=l},expression:"addIllegal.cause"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",slot:"footer"},[t("el-button",{on:{click:function(l){e.illegalVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.addIllegalFun}},[e._v("添 加")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"惩罚",visible:e.punishVisible},on:{"update:visible":function(l){e.punishVisible=l}}},[t("el-form",{ref:"addPunish",attrs:{model:e.addPunish,"label-width":"80px",rules:e.punishRules}},[t("el-form-item",{attrs:{label:"用户"}},[t("span",[e._v(e._s(e.addPunish.user_id))])]),e._v(" "),t("el-form-item",{attrs:{label:"类型"}},[t("span",[e._v(e._s(e.addPunish.type))])]),e._v(" "),t("el-form-item",{attrs:{label:"数量",prop:"count"}},[t("el-input",{attrs:{type:"number",placeholder:"请输入惩罚抵消的违规数量"},model:{value:e.addPunish.count,callback:function(l){e.addPunish.count=l},expression:"addPunish.count"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"时间",prop:"time"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期时间",align:"right"},model:{value:e.addPunish.time,callback:function(l){e.addPunish.time=l},expression:"addPunish.time"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"内容",prop:"content"}},[t("el-input",{attrs:{type:"textarea",placeholder:"请输入惩罚内容"},model:{value:e.addPunish.content,callback:function(l){e.addPunish.content=l},expression:"addPunish.content"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",slot:"footer"},[t("el-button",{on:{click:function(l){e.punishVisible=!1}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(l){e.addPunishFun("addPunish")}}},[e._v("惩 罚")])],1)],1)],1)},staticRenderFns:[]}}});